# Maintainer: 謝致邦 <Yeking@Red54.com>

pkgname=android-tools
pkgver=20130224
pkgrel=1
pkgdesc="Android platform tools(adb, fastboot)"
arch=('i686' 'x86_64' 'armv7h')
depends=('libusb')
makedepends=('gcc' 'git' 'make')
provides=('adb' 'fastboot')
conflicts=('adb' 'fastboot')
url="http://android.googlesource.com/platform/system/core"
license=('Apache')
source=('adbMakefile' 'fastbootMakefile')
md5sums=('887d868e544330ef850334961685cab3'
	'cd1a1a9d16b523119245bfe17120d73b')

_opt=" --depth=1"
_extras="https://android.googlesource.com/platform/system/extras"
_libselinux="http://android.googlesource.com/platform/external/libselinux"

build() {
	cd $srcdir
	if [[ -d core ]]; then
		cd core && git pull origin
	else
		git clone $url$_opt
	fi
	cd $srcdir
	if [[ -d extras ]]; then
		cd extras && git pull origin
	else
		git clone $_extras$_opt
	fi
	cd $srcdir
	if [[ -d libselinux ]]; then
		cd libselinux && git pull origin
	else
		git clone $_libselinux$_opt
	fi
	cd $srcdir/core/adb
	mv ../../adbMakefile makefile
	make
	cd ../fastboot
	mv ../../fastbootMakefile makefile
	make
}

package(){
	cd ${srcdir}/core
	install -D adb/adb ${pkgdir}/usr/bin/adb
	install -D fastboot/fastboot ${pkgdir}/usr/bin/fastboot
}
